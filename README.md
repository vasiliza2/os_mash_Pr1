

## Отчет "Практическая работа 1"


-----

### Обзор проекта

Этот проект предназначен для **прогнозирования качества вина** на основе его физико-химических свойств. Проект включает в себя полный цикл машинного обучения: от подготовки данных до создания и документирования API-сервиса.

-----

### Структура проекта

Проект организован следующим образом:

```

        ├── WineQT.csv                     # Исходные данные о вине
        ├── app.py                         # Flask-сервер для API
        ├── best_wine_quality_model.pkl    # Обученная модель
        ├── scaler.pkl                     # Обученный стандартизатор данных
        ├── wine.ipynb                     # Jupyter Notebook с этапами обучения
        ├── requirements.txt               # Зависимости Python
        └── swagger_spec.json              # OpenAPI (Swagger) спецификация API
```

-----

### Этапы работы

1.  **Подготовка данных**:

      * Данные загружены из файла `WineQT.csv`.
      * Проведен первичный анализ, включая проверку размерности, типов данных и наличия пропущенных значений.
      * Целевой столбец `quality` и идентификатор `Id` были разделены на признаки (`X`) и целевую переменную (`y`).
      * Данные разделены на обучающую, валидационную и тестовую выборки (65%/15%/20% соответственно) с использованием стратификации для сохранения распределения классов.
      * **Пропущенные значения** обработаны с помощью медианного импутации.
      * **Выбросы** были нивелированы с помощью `RobustScaler`.
      * Данные **стандартизированы** с использованием `StandardScaler`. Оба трансформатора (`best_wine_quality_model.pkl` и `scaler.pkl`) сохранены для будущего использования.

2.  **Обучение и оценка моделей**:

      * Обучен и оценен ряд моделей классификации, включая Logistic Regression, Decision Tree, Random Forest, Gradient Boosting, SVC, KNeighbors, MLPClassifier и DummyClassifier.
      * Модели оценены по **Accuracy**, **F1-score** (взвешенный) и **ROC AUC** на валидационной выборке.
      * Выбрана **лучшая модель** на основе F1-score, которая затем сохранена в файл `best_wine_quality_model.pkl`.

3.  **Создание и тестирование API**:

      * Разработан **Flask-сервер** (`app.py`), который загружает сохраненную модель и стандартизатор.
      * API-эндпоинт `/predict` принимает JSON-запросы с характеристиками вина и возвращает предсказанное качество.
      * Сервер готов к работе на локальном порту 5000.

4.  **Документация API (Swagger)**:

      * Создана **отдельная спецификация OpenAPI (Swagger) в JSON-формате** (`swagger_spec.json`), которая подробно описывает API.

-----

### Тестирование API

Для тестирования API отправьте **POST-запрос** на `http://127.0.0.1:5000/predict` с JSON-телом, содержащим следующие параметры:

```json
{
    "fixed acidity": 7.4,
    "volatile acidity": 0.70,
    "citric acid": 0.00,
    "residual sugar": 1.9,
    "chlorides": 0.076,
    "free sulfur dioxide": 11.0,
    "total sulfur dioxide": 34.0,
    "density": 0.9978,
    "pH": 3.51,
    "sulphates": 0.56,
    "alcohol": 9.4
}
```



